<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.mapper.MemberMapper">

	<resultMap id="signUpMap" type="com.spring.member.MemberVO">
		<result property="email" column="email" />
		<result property="usergroup" column="usergroup" />
		<result property="nickname" column="nickname" />
		<result property="name" column="name" />
		<result property="password" column="password" />
		<result property="phone" column="phone" />
		<result property="address" column="address" />
		<result property="address_detail" column="address_detail" />
		<result property="postal_num" column="postal_num" />
		<result property="birth" column="birth" />
		<result property="children_birth" column="children_birth" />
		<result property="point" column="point" />
		<result property="regist" column="regist" />
		<result property="subscribe" column="subscribe" />
		<result property="instagram_id" column="instagram_id" />
		<result property="receive_email" column="receive_email" />
		<result property="receive_text" column="receive_text" />
		<result property="img" column="img" />

	</resultMap>

	<select id="nicknameCheck" resultMap="signUpMap">
		select * from member where nickname = #{nickname}
	</select>

	<select id="emailCheck" resultMap="signUpMap">
		select * from member where email = #{email}
	</select>

	<update id="verifyEmail" parameterType="com.spring.member.MemberVO" >
		update member set email_state='Y' where email= #{email}
	</update>
	
	<insert id="memberInsert" parameterType="com.spring.member.MemberVO" >
		insert into member(email, usergroup, nickname, name, password, phone, address, address_detail, postal_num, birth, children_birth,  point, regist, last_connection, subscribe, instagram_id, receive_email, receive_text, img) 
		values (#{email}, '일반회원', #{nickname}, #{name}, #{password}, #{phone},	#{address}, #{address_detail}, #{postal_num}, #{birth}, #{children_birth}, 0, sysdate, sysdate, 'N', #{instagram_id}, #{receive_email}, #{receive_text}, #{img})
	</insert>
	
	<!-- 이메일 찾기 -->
	<select id="findEmail" parameterType="com.spring.member.MemberVO" resultMap="signUpMap">
		select email from member where name = #{name} and phone = #{phone}
	</select>
	
	<!-- 비밀번호 찾기 -->
	<select id="findPassword" parameterType="com.spring.member.MemberVO" resultMap="signUpMap">
		select password from member where name = #{name} and phone = #{phone} and email = #{email}
	</select>
	
	<update id="updatepassword" parameterType="com.spring.member.MemberVO">
		update member set password = #{password} where name = #{name} and phone = #{phone} and email = #{email}
	</update>
</mapper>
